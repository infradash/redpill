## Circle CI configuration
machine:
  services:
    - docker

  timezone:
    America/Los_Angeles

  # Override /etc/hosts
  hosts:
    circlehost: 127.0.0.1

  # Add some environment variables
  environment:
    BINARY: redpill
    GOPATH: $HOME/go
    PATH: $GOPATH/bin:$PATH
    CIRCLE_ENV: test
    BUILD_DIR: build/bin

## Customize dependencies
dependencies:
  pre:
    - go version
    - bin/get_build_info.sh

  override:
    - source ./hack/env.sh

## Customize test commands
test:
  override:
    - source ./hack/env.sh && make
    - cp $BUILD_DIR/* $CIRCLE_ARTIFACTS
